// import data from '../data/index.json' assert {type: 'json'};
// const data = require('../data/index.json');

const dataJson = [
    {
        "name" : "Apple MacBook Pro 16 M3 Pro/512 MRW13TH/A (Space Black)",
        "description" : "หน้าจอแสดงผลขนาด 16.2 Liquid Retina XDR display ชิป Apple M3 Pro พร้อม CPU แบบ 12-core GPU แบบ 18-core Neural Engine ชิปเซ็ตพิเศษที่โฟกัสการทำงานให้กับเทคโนโลยี AIมาพร้อมตัวจัดเก็บ SSD 512GB และ หน่วยความจำรวมขนาด 18GBอะแดปเตอร์แปลงไฟ USB-C ขนาด 140 วัตต์Magic Keyboard แบ็คไลท์ พร้อม Touch IDมาพร้อมระบบปฏิบัติการ macOS",
        "price" : 94900,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0155720/A0155720OK_BIG_1.jpg"
    },
    {
        "name" : "MacApple MacBook Pro 16 M3 Pro/512 MRW63TH/A (Silver)",
        "description" : "หน้าจอแสดงผลขนาด 16.2 Liquid Retina XDR display ชิป Apple M3 Pro พร้อม CPU แบบ 12-core GPU แบบ 18-core Neural Engine ชิปเซ็ตพิเศษที่โฟกัสการทำงานให้กับเทคโนโลยี AI มาพร้อมตัวจัดเก็บ SSD 512GB และ หน่วยความจำรวมขนาด 18GB อะแดปเตอร์แปลงไฟ USB-C ขนาด 140 วัตต์ Magic Keyboard แบ็คไลท์ พร้อม Touch ID มาพร้อมระบบปฏิบัติการ macOS",
        "price" : 108900,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0155723/A0155723OK_BIG_1.jpg"
    },
    {
        "name" : "Apple MacBook Pro 14 M3 Max/1TB MRX83TH/A (Silver)",
        "description" : "หน้าจอแสดงผลขนาด 14.2 Liquid Retina XDR display ชิป Apple M3 Max พร้อม CPU แบบ 14-core, GPU แบบ 30-core Neural Engine ชิปเซ็ตพิเศษที่โฟกัสการทำงานให้กับเทคโนโลยี AI มาพร้อมตัวจัดเก็บ SSD 1TB และ หน่วยความจำรวมขนาด 36GB อะแดปเตอร์แปลงไฟ USB-C ขนาด 96 วัตต์ Magic Keyboard แบ็คไลท์ พร้อม Touch ID มาพร้อมระบบปฏิบัติการ macOS",
        "price" : 121900,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0155719/A0155719OK_BIG_1.jpg"
    },
    {
        "name" : "Apple MacBook Pro 16 M3 Pro/512 MRW13TH/A (Space Black)",
        "description" : "หน้าจอแสดงผลขนาด 14.2 Liquid Retina XDR display ชิป Apple M3 Max พร้อม CPU แบบ 14-core, GPU แบบ 30-core Neural Engine ชิปเซ็ตพิเศษที่โฟกัสการทำงานให้กับเทคโนโลยี AI มาพร้อมตัวจัดเก็บ SSD 1TB และ หน่วยความจำรวมขนาด 36GB อะแดปเตอร์แปลงไฟ USB-C ขนาด 96 วัตต์ Magic Keyboard แบ็คไลท์ พร้อม Touch ID มาพร้อมระบบปฏิบัติการ macOS",
        "price" : 94900,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0155720/A0155720_1.jpg"
    },{
        "name" : "Monitor 27'' SAMSUNG LS27C900PAEXXT (IPS, HDMI, DP, USB-C, SPK) 5K 60Hz",
        "description" : " Display : 27 IPS Response Time : 5ms (GTG) Resolution : 5120 x 2880 @60Hz Contrast Ratio : 1000:1 Interface : Mini-DisplayPort x1,Thunderbolt x1,USB-C x3 Smart TV : Operating System Tizen OS WiFi5 / Bluetooth BT4.2 มาพร้อมลำโพงคู่ในตัว 5W",
        "price" : 43900,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0152378/A0152378_1.jpg"
    },{
        "name" : "BLUETOOTH MULTI-DEVICE KEYBOARD LOGITECH POP KEYS DAYDREAM",
        "description" : "Interface : BLUETOOTH Keys Windows Layout : 85 Keys ประเภท Keycap : EN / TH มีซอฟต์แวร์ Logitech หรือแตะปุ่มเมนูอิโมจิ ได้ในระหว่างที่แชทกับเพื่อน มีปุ่มลัด FN 12 ปุ่มช่วยในการทำงานดีขึ้น ขนาดกะทัดรัด สามารถเชื่อมต่อสูงสุดได้พร้อมกันถึง 3 อุปกรณ์ อายุแบตเตอรี่ใช้งานได้ถึง 3 ปี สามารถใช้งานได้ทั้ง Windows ,macOS ,iPadOS ,iOS ,Chrome OS และ Android",
        "price" : 2990,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0141269/A0141269_1.jpg"
    },
    {
        "name" : "ลำโพง MARSHALL (Woburn III) BLUETOOTH Black",
        "description" : " Port : AUX 3.5 mm / Bluetooth 5.2 / RCA / HDMI Power Output : 90 W Home shaking sound Pair, play and turn it up Iconic design that stands apart HDMI connectivity",
        "price" : 28900,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0155272/A0155272_1.jpg"
    },
    {
        "name" : "EPSON L15150+ INK TANK",
        "description" : " Print Speed : ขาวดำ 32 / สี 22 (แผ่น/นาที) Resolution : สูงสุด 4800 x 2400 dpi Copy Resolution : สูงสุด 600 x 600 dpi Scan Resolution : สูงสุด 1200 x 2400 dpi ถาดบรรจุกระดาษ : 250 แผ่น การเชื่อมต่อ : USB / WiFi รองรับการพิมพ์ได้ถึงขนาด A3 รองรับการถ่ายเอกสารได้ถึงขนาด A3 รองรับการสแกนเอกสารได้ถึงขนาด A3 Black Ink Refill 008 BK (7,500 pages) Color Ink Refill 008 C, 008 M, 008 Y (6,000 pages)",
        "price" : 26700,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0132769/A0132769_1.jpg"
    },
    {
        "name" : "USB MOUSE RAPOO EV200-BK-SILENT BLACK",
        "description" : "ประเภทการเชื่อมต่อ : USB Resolution : 1,600 DPI จำนวนปุ่ม : 6 Buttons Vertical ergonomic design 3 buttons including a 2D non-slip scroll wheel plug and play",
        "price" : 1090,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0144730/A0144730_1.jpg"
    },
    {
        "name" : "CHAIR BEWELL ERGONOMIC ENCLOSE PLUS",
        "description" : " ENCLOSE PLUS เก้าอี้ขจัดออฟฟิศซินโดรม ด้วยเบาะใหม่ ไซส์ใหญ่ขึ้น ออกแบบตามหลัก ERGONOMICS โดยนักกายภาพบำบัดผู้เชี่ยวชาญด้านการยศาสตร์ตัวจริง ! เปลี่ยนการนั่งของคุณให้ดีตั้งแต่ก้นสัมผัสเบาะ นั่งสบายที่สุด คลายกดทับ บรรเทาอาการปวดก้นกบ ปวดหลัง และปวดคอ บ่า ไหล่ และรองรับคนหลังแอ่น",
        "price" : 24999,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0156227/A0156227_1.jpg"
    },
    {
        "name" : "1 TB SSD M.2 PCIe 5.0 GIGABYTE AORUS 12000 (AG512K1TB)",
        "description" : " Capacity : 1TB Interface : PCIe Gen 5, NVMe 2.0 Form Factor : M.2 2280 Sequential Read : Up to 11,700 MB/s Sequential Write : Up to 9,500 MB/s",
        "price" : 6990,    
        "image_url" : "https://img.advice.co.th/images_nas/pic_product4/A0154665/A0154665_1.jpg"
    }
]

// LocalStorage
const Cart = JSON.parse(localStorage.getItem("Cart")) || [];

const Delete = (id) => {
    const indexToRemove = Cart.findIndex((item) => item === id);

    if (indexToRemove !== -1) {
        Cart.splice(indexToRemove, 1);
        localStorage.setItem("Cart", JSON.stringify(Cart));
        alert("ลบสินค้าออกจากตะกร้าแล้ว");
        updateCount();
    } else {
        alert("ไม่พบสินค้านี้ในตะกร้า");
    }

}

updateCount = () => {
    const count_item_ele = document.querySelector("#count_item");

    count_item_ele.innerHTML = Cart.length
}
window.onload = () => {
    console.log("load DOM");
    const Cart_ele = document.querySelector("#sidebar");
    

    const itemcart_ele = document.querySelector("#list_cart");

    updateCount();

    const Togg = document.querySelector("#Togg");

    Togg.addEventListener("click", () => {
        Cart_ele.classList.toggle('toggle');
        Cart_ele.classList.toggle('active');
    })
    setInterval(() => {
        if (Cart.length !== 0) {
            Cart_ele.classList.add('active');
        } else {
            Cart_ele.classList.remove('active');
        }
        itemcart_ele.innerHTML = "";
        Cart.map((item, i) => {
            const data = dataJson[item];
            itemcart_ele.innerHTML +=`
            <div class="item_cart" id="item_cart">
                <div class="image_cart">
                    <img src="${data.image_url}" alt="">
                </div>

                <span id="Name" class="Name">
                    ${data.name}
                </span>

                <div class="menu">
                    <span onclick="Delete(${item})"><i class="fa-solid fa-trash"></i></span>
                </div>
            </div>`;
        });
    }, 1000);

    
    // Data Init
    const item_ele = document.querySelector("#list-item");
    item_ele.innerHTML = "";
    dataJson.map((item, i) => {
        item_ele.innerHTML += (`
            <div class="item" onclick>
                <div class="item-image">
                    <img src="${item.image_url}" alt="">
                </div>
            <div class="item-con">
                <div class="item-text">
                    <div class="name">
                    <span style="opacity:0.7;">ชื่อสินค้า :</span>
                        ${item.name}
                    </div>

                    <div class="description" >
                        ${item.description}
                    </div>
                    
                    <!-- Price -->
                    
                    <div class="price">
                    <span style="opacity:0.7;">ราคา :    </span>
                        ${numberWithCommas(item.price)}
                    </div>

                </div>

                <div class="btn" onclick="AddToCart(${i})">
                    <i class="fa-solid fa-cart-shopping"></i>&nbsp;Add To Cart
                </div>
                </div>
            </div>
        `) 

    });
    
    
}
// Add To Cart
AddToCart = (id) => {
    // Set in Array
    
    const selectedItem = id;
    const existingIndex = Cart.findIndex((item, i) => i === id);

    if (existingIndex === -1) {
        Cart.push(selectedItem);
        localStorage.setItem("Cart", JSON.stringify(Cart));
        alert("เพิ่มเข้าตะกร้าแล้วจร้าาา");
        updateCount();
    } else {
        alert("คุณมีสินค้านี้อยู่แล้วงับ");
    }
    
}
function numberWithCommas(x) {
    x = x.toString();
    var pattern = /(-?\d+)(\d{3})/;
    while (pattern.test(x))
        x = x.replace(pattern, "$1,$2");
    return x;
}